*****************************************File sharing in ubuntu**********************************************

âœ… OPTION 1: File Sharing with Windows/Linux via Samba (SMB)


ğŸ”¹ Step 1: Install Samba (only once)
Open Terminal and run:

sudo apt update
sudo apt install samba -y


ğŸ”¹ Step 2: Share a Folder

Create or choose the folder to share:
mkdir ~/shared-folder


Set permissions:
chmod -R 777 ~/shared-folder


Edit the Samba config:
sudo nano /etc/samba/smb.conf


Add this to the bottom of the file:
[Shared]
path = /home/yourusername/shared-folder
browseable = yes
read only = no
guest ok = yes
Replace yourusername with your actual Ubuntu username

Restart Samba:
sudo systemctl restart smbd



ğŸ”¹ Step 3: Access from Another PC

From Windows, press Win + R and type:
\\<ubuntu-ip-address>\Shared

Example:
\\192.168.1.100\Shared

From another Ubuntu/Linux PC, open Files â†’ Other Locations â†’ type:
smb://192.168.1.100/Shared


ğŸ” Optional: Set Samba User Authentication

Add a Samba user:
sudo smbpasswd -a yourusername


Update smb.conf:
guest ok = no
valid users = yourusername

Restart:
sudo systemctl restart smbd


**************************************how to give permission to everyone with full control***************************************


To give everyone full control (read/write access) to a shared folder in Ubuntu using Samba, follow these two parts:

âœ… PART 1: Set Linux File/Folder Permissions

Letâ€™s say your folder is:
/home/jency/shared-folder


ğŸŸ¢ Step 1: Allow all users full access in Ubuntu:
sudo chmod -R 777 /home/jency/shared-folder

-R â†’ applies to all subfolders and files
777 â†’ gives read, write, and execute permission to owner, group, and others

âœ… PART 2: Configure Samba to Allow Everyone

Edit the Samba config:
sudo nano /etc/samba/smb.conf


At the bottom of the file, add or update your share block:
[Shared]
path = /home/jency/shared-folder
browseable = yes
read only = no
guest ok = yes
force user = jency
create mask = 0777
directory mask = 0777
ğŸ” Replace jency with your actual Ubuntu username

âœ… Save and Exit nano:
Press Ctrl + O â†’ Enter
Then Ctrl + X to exit

ğŸ” Restart Samba:
sudo systemctl restart smbd


ğŸ§ª TEST ACCESS

On another PC (Windows):
Press Win + R â†’ type:
\\<your-ubuntu-ip>\Shared

You should now be able to view, create, edit, and delete files in that shared folder without login (guest access).


**************************in ubuntu os how can we give limited permission to particular user on particular folder********************************

ğŸ‘Œ Letâ€™s break down exactly what you want:

âœ… One Ubuntu machine in your office
âœ… Share a folder from that Ubuntu machine
âœ… Allow multiple Windows or Linux PCs on your office network to access it
âœ… Give each user different limited permissions

â†’ This is a classic office file server setup using Samba, with per-user permissions.

ğŸŸ¢ Step-by-Step: Ubuntu Network File Server with Controlled Access


ğŸ§° Step 1: Install Samba
On your Ubuntu machine (the â€œserverâ€):
sudo apt update
sudo apt install samba -y


ğŸ§° Step 2: Create the Shared Folder
Example:
sudo mkdir -p /srv/samba/shared

ownership to your own user:
sudo chown -R $USER:$USER /srv/samba/shared


ğŸ§° Step 3: Create Samba Users
Say you have 3 employees:

employee1

employee2

employee3

First create their Linux accounts:

sudo adduser employee1
sudo adduser employee2
sudo adduser employee3
Now add them to Samba:

sudo smbpasswd -a employee1
sudo smbpasswd -a employee2
sudo smbpasswd -a employee3
(youâ€™ll be prompted for their passwords)


ğŸ§° Step 4: Configure Samba Share

Edit the Samba config:
sudo nano /etc/samba/smb.conf

Add this block at the end:
[OfficeShared]
path = /srv/samba/shared
browsable = yes
read only = no
valid users = employee1, employee2, employee3
create mask = 0660
directory mask = 0770

âœ… Explanation:

valid users: only these usernames can access

0660: files will have read/write for owner & group, no rights for others

0770: folders will have read/write/execute for owner & group


ğŸ§° Step 5: Set Folder Permissions

Make sure only those users can read/write:
sudo chown -R root:employee1 /srv/samba/shared
sudo chmod -R 770 /srv/samba/shared

If you want all three to manage files, you can instead create a shared group:
sudo groupadd officeusers
sudo usermod -aG officeusers employee1
sudo usermod -aG officeusers employee2
sudo usermod -aG officeusers employee3
sudo chown -R root:officeusers /srv/samba/shared
sudo chmod -R 770 /srv/samba/shared
That way everyone in officeusers group can read/write the share.

ğŸ§° Step 6: Restart Samba
sudo systemctl restart smbd


ğŸ§° Step 7: Access from Other PCs

On Windows:
Press Win + R â†’ type
\\192.168.1.50\OfficeShared
(replace with your Ubuntu server IP)

Enter the username and password (like employee1 / the Samba password you set)

On Linux:

Open Files â†’ Connect to Server:
smb://192.168.1.50/OfficeShared
Login with the same user credentials


*******************************instead of username i want to create it with ip address or userid****************************************


ğŸŸ¢ 1ï¸ Restrict Share Access to Specific IPs
You can restrict which IP addresses can even connect to the share, using hosts allow and hosts deny:
[OfficeShared]
   path = /srv/samba/shared
   browsable = yes
   read only = no
   valid users = employee1, employee2
   hosts allow = 192.168.1.5 192.168.1.6
   hosts deny = 0.0.0.0/0
That means only 192.168.1.5 and 192.168.1.6 can connect at all.
But permissions inside the folder are still by username. Samba cannot assign file permissions purely by IP.

ğŸŸ¢ 2ï¸ Using â€œuser IDsâ€ (usernames)
In Linux and Samba, a userid is essentially the username â€” that is how permissions are designed. So if you say:

â€œI want to do it with useridâ€

âœ… That is exactly what Samba does already. Each user you create:

Linux user â†’ adduser employee1

Samba user â†’ smbpasswd -a employee1

That is your â€œuseridâ€ permission system.


********************************What if I want one user to read only and another user to read write and another to excute*******************************

USE OF ACL (ACCESS CONTROL LIST):-

# install ACL if needed
sudo apt update
sudo apt install acl -y

# create the folder
sudo mkdir -p /srv/samba/shared

# set ownership to root for neutral permissions
sudo chown root:root /srv/samba/shared

# restrictive base permissions
sudo chmod 700 /srv/samba/shared

# create the users
sudo adduser readuser
sudo adduser rwuser
sudo adduser execuser

# set samba passwords for these users
sudo smbpasswd -a readuser
sudo smbpasswd -a rwuser
sudo smbpasswd -a execuser

# apply ACL permissions:
sudo setfacl -m u:readuser:r-- /srv/samba/shared
sudo setfacl -m u:rwuser:rw- /srv/samba/shared
sudo setfacl -m u:execuser:--x /srv/samba/shared

# verify
getfacl /srv/samba/shared


Edit your Samba config:
sudo nano /etc/samba/smb.conf

Add at the very bottom:

[OfficeShared]
   path = /srv/samba/shared
   browseable = yes
   read only = no
   valid users = readuser, rwuser, execuser


Save (Ctrl+O â†’ Enter â†’ Ctrl+X), then restart Samba:

sudo systemctl restart smbd

NOW TEST THE CONNECTION!!!!!!!!

_____________________________________ACTUAL PRACTICAL WE DID________________________________


# install ACL if not already
sudo apt update
sudo apt install acl -y

# create the shared folder
sudo mkdir -p /srv/samba/shared

# set ownership to root
sudo chown root:root /srv/samba/shared

# set restrictive base permission
sudo chmod 700 /srv/samba/shared

# create users (if not already created)
sudo adduser jency
sudo adduser dhruvi

# set Samba passwords for Windows access
sudo smbpasswd -a jency
sudo smbpasswd -a dhruvi

# apply ACL permissions:
sudo setfacl -m u:jency:rwx /srv/samba/shared
sudo setfacl -m u:dhruvi:r-- /srv/samba/shared

# verify ACL
getfacl /srv/samba/shared


-----------------------------------edit your Samba config---------------------------------------

sudo nano /etc/samba/smb.conf
add this block at the bottom:

[Shared]
   path = /srv/samba/shared
   browseable = yes
   read only = no
   valid users = jency, dhruvi
save and exit (Ctrl+O â†’ Enter, Ctrl+X), then restart Samba:

sudo systemctl restart smbd


what should be the original file permission???????????????????????????????????????



Because youâ€™re using ACL, the base permissions of the folder should be restrictive, so that only ACL rules will grant access.

ğŸ‘‰ So the recommended original permission for your shared folder:

sudo chmod 700 /srv/samba/shared


which means:
owner (root): read/write/execute
group: no permissions
others: no permissions

âœ… That way, only the ACL rules you defined will decide who can read, write, or execute.

ğŸ§© Why not 777?
777 would give everyone full access, ignoring ACL security

defeats your fine-grained controls

ğŸ§© Why not 755?
755 would allow everyone to read and enter the folder

again, breaks your per-user ACL restrictions

âœ… So stick to:

chmod 700 /srv/samba/shared

plus:
setfacl -m u:jency:rwx /srv/samba/shared
setfacl -m u:dhruvi:r-- /srv/samba/shared

"""""""""""""""""""""""""""""""""""""""""""""""""""sudo chmod 2775 /srv/samba/shared    explain this"""""""""""""""""""""""""""""""""""""""""""""""""""""""

sudo chmod 2775 /srv/samba/shared ma shun thay che, e breakdown kariye:

2 â†’ setgid bit

meaning: je group owner che, e directory ma je nava file/folder create thashe, tene automatically same group male

example: group â€œsambashareâ€ hoy, to ema nava files pan â€œsambashareâ€ group ma avse

aa office ma multi-user sharing ma helpful hoy

7 â†’ owner permissions:

rwx â†’ read, write, execute

7 â†’ group permissions:

rwx â†’ read, write, execute

5 â†’ others permissions:

r-x â†’ read, execute (write nathi)   




((((((((((((((((((((((((((mari pase jency and dhruvi am 2 user che ane group ma kai rite add karu and group ne permission kai rite set karu))))))))))))))))))))))))))


âœ… Situation:

-2 users: jency and dhruvi
-tame ema group banavi ne group-based permission control karvu chhe


ğŸ”¸ 1ï¸ Navo group banavo
example group name: sambashare
sudo groupadd sambashare


ğŸ”¸ 2ï¸ Users ne aa group ma add karo
sudo usermod -aG sambashare jency
sudo usermod -aG sambashare dhruvi

ğŸ” -aG means append to group â€” existing groups remove nahi thay.


ğŸ”¸ 3ï¸ Group permission folder par set karo
maan lo tame folder /srv/samba/shared share karva magta:
sudo chown -R root:sambashare /srv/samba/shared
â†’ owner = root, group = sambashare


ğŸ”¸ 4ï¸ Folder permission set karo
sudo chmod 2775 /srv/samba/shared


ğŸ”¸ 5ï¸ check karo group membership
groups jency
groups dhruvi
e confirm karse ke group sambashare ma successfully add thay gaya.


ğŸ”¸ 6ï¸ Samba config update karo (optional)
[SharedFolder]
   path = /srv/samba/shared
   valid users = @sambashare
   read only = no
â†’ @sambashare means group na badha members access kari shake.

summary:

group sambashare banavyo

users add kariya

folder permission set kari

samba config kari




You said:
two multiple user and two multiple group


ChatGPT said:


âœ… Scenario Example
Users:

jency

dhruvi

Groups:

accounts

developers

and suppose tame aa rakhu chho:

jency â†’ belongs to accounts

dhruvi â†’ belongs to developers

optionally, both can be added to a common group (e.g. sambashare) for shared folder access.

ğŸ”¸ 1ï¸ create 2 groups

sudo groupadd accounts
sudo groupadd developers


ğŸ”¸ 2ï¸ add users to groups

sudo usermod -aG accounts jency
sudo usermod -aG developers dhruvi

ğŸ”¸ 3ï¸ common group (for shared folder)

if required:
sudo groupadd sambashare
sudo usermod -aG sambashare jency
sudo usermod -aG sambashare dhruvi
â†’ ena thi sambashare group ma badha shared access kari shake


ğŸ”¸ 4ï¸ set folder ownership
maan lo tame /srv/samba/shared share karo chho:
sudo chown -R root:sambashare /srv/samba/shared


ğŸ”¸ 5ï¸ permission set
bash
Copy
Edit
sudo chmod 2775 /srv/samba/shared


ğŸ”¸ 6ï¸ check memberships

groups jency
groups dhruvi
tamne output avse jem ke:

jency : jency accounts sambashare
dhruvi : dhruvi developers sambashare


ğŸ”¸ 7ï¸ Samba config

[SharedFolder]
   path = /srv/samba/shared
   valid users = @sambashare
   read only = no


primary groups: accounts, developers

shared group: sambashare

folder sambashare na base par control thase

jency/dhruvi easily personal group pan use kari shake (like for their own folders)





You said:
without common sambashare group


ChatGPT said:


âœ… Scenario
users:

jency

dhruvi

groups:

accounts (jency no group)

developers (dhruvi no group)

tamare koi common group banavvano nathi, pan alag group-based permission manage karvu chho.


ğŸ”¸ 1ï¸ group create karo

sudo groupadd accounts
sudo groupadd developers


ğŸ”¸ 2ï¸ users ne group ma add karo

sudo usermod -aG accounts jency
sudo usermod -aG developers dhruvi


ğŸ”¸ 3ï¸ folder permission structure
maan lo tame 2 folders share karo:

/srv/samba/accounts â†’ for accounts group

/srv/samba/developers â†’ for developers group


folders create karo:
sudo mkdir -p /srv/samba/accounts
sudo mkdir -p /srv/samba/developers


ownership set karo:
sudo chown -R root:accounts /srv/samba/accounts
sudo chown -R root:developers /srv/samba/developers


permissions set karo (with setgid):
sudo chmod 2775 /srv/samba/accounts
sudo chmod 2775 /srv/samba/developers


â†’ aa thi accounts group ma bijo user file mukse to pan group same rahse.



ğŸ”¸ 4ï¸ Samba config

accounts folder mate:
[AccountsShare]
   path = /srv/samba/accounts
   valid users = @accounts
   read only = no


developers folder mate:
[DevelopersShare]
   path = /srv/samba/developers
   valid users = @developers
   read only = no

ğŸ” Summary:-

koi common group nathi

accounts folder only accounts group use karse

developers folder only developers group use karse

setgid thi group ownership preserve thase


















